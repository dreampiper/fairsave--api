{"version":3,"file":"index.23b74acf1271e9aacfed.js","mappings":"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","sources":["webpack://fairsave/webpack/bootstrap","webpack://fairsave/webpack/runtime/make namespace object","webpack://fairsave/./src/ts/index.ts","webpack://fairsave/./src/ts/utils/copyTextToClipboard.ts"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","require(\"../css/main.css\");\nimport copyTextToClipboard from \"./utils/copyTextToClipboard\";\n\n/* --------------- Global Vars --------------- */\n// Don't try this at work :P.\n\nlet cid: string;\nlet title: string;\n\nconst server = \"http://localhost:3000\";\n\n/* --------------- Get DOM --------------- */\n\n// Inputs.\nconst inputIds = [\"upload\", \"upload2\", \"saveBookmarkInput\", \"getBookmarkInput\"];\nconst inputs: { [key: string]: HTMLInputElement } = {};\ninputIds.forEach((id) => {\n  inputs[id] = document.getElementById(id) as HTMLInputElement;\n});\n\n// Contents e.g div p.\nconst contentIds = [\n  \"tutorial\",\n  \"homeButtons\",\n  \"fileUploadStats\",\n  \"fileUploadStats--title\",\n  \"fileUploadStats--progress-bar\",\n  \"fileUploadStats--uploadPercent\",\n  \"findModal\",\n  \"findModalContainer\",\n  \"saveModal\",\n  \"saveModalContainer\",\n  \"view1\",\n  \"view2\",\n  \"imageHolder\",\n];\n\nconst content: { [key: string]: HTMLParagraphElement | HTMLDivElement } = {};\ncontentIds.forEach((id) => {\n  content[id] = document.getElementById(id) as\n    | HTMLParagraphElement\n    | HTMLDivElement;\n});\n\n// Buttons.\nconst buttonIds = [\"find\", \"bookmark\", \"getBookmark\", \"saveBookmark\", \"share\"];\nconst buttons: { [key: string]: HTMLButtonElement } = {};\nbuttonIds.forEach((id) => {\n  buttons[id] = document.getElementById(id) as HTMLButtonElement;\n});\n\n/* --------------- Actions --------------- */\n\ninputs.upload.onchange = () => {\n  const file = (inputs.upload.files as FileList)[0];\n  initUploadState(file);\n  uploadImage(file);\n  setImageHolder(file);\n};\n\ninputs.upload2.onchange = () => {\n  content.view1.style.display = \"flex\";\n  content.view2.style.display = \"none\";\n  const file = (inputs.upload2.files as FileList)[0];\n  setImageHolder(file);\n  initUploadState(file);\n  uploadImage(file);\n};\n\nbuttons.find.onclick = () => {\n  content.findModal.style.display = \"flex\";\n};\n\nbuttons.bookmark.onclick = () => {\n  content.saveModal.style.display = \"flex\";\n};\n\nbuttons.share.onclick = () => {\n  const href = `https://${cid}.ipfs.w3s.link`;\n  copyTextToClipboard(href);\n  alert(\"Copied Link\");\n};\n\nbuttons.saveBookmark.onclick = (ev) => {\n  ev.preventDefault();\n  saveBookmark();\n};\n\nbuttons.getBookmark.onclick = (ev) => {\n  ev.preventDefault();\n  getBookmark();\n};\n\ncontent.findModal.onclick = () => {\n  content.findModal.style.display = \"none\";\n};\n\ncontent.findModalContainer.onclick = function (ev) {\n  ev.stopPropagation();\n};\n\ncontent.saveModal.onclick = () => {\n  content.saveModal.style.display = \"none\";\n};\n\ncontent.saveModalContainer.onclick = function (ev) {\n  ev.stopPropagation();\n};\n\n/* --------------- Action Handlers --------------- */\n\nfunction initUploadState(file: File) {\n  // Hide #homeButtons.\n  content.homeButtons.style.display = \"none\";\n\n  // Hide #tutorial.\n  content.tutorial.style.display = \"none\";\n\n  // Show #fileUploadStats.\n  content.fileUploadStats.style.display = \"flex\";\n\n  // Get progress.\n  const pb = document.querySelector(\n    \"#fileUploadStats--progress-bar > div\"\n  ) as HTMLDivElement;\n  let progress = parseInt(pb.style.width, 10);\n  progress = 0;\n\n  pb.style.width = progress + \"%\";\n\n  // Set #fileUploadStats values\n  content[\"fileUploadStats--title\"].innerHTML = file.name;\n  content[\"fileUploadStats--uploadPercent\"].innerHTML = \"0%\";\n}\n\nfunction uploadImage(file: File) {\n  const formdata = new FormData();\n  formdata.append(\"image\", file);\n\n  const ajax = new XMLHttpRequest();\n  ajax.upload.addEventListener(\"progress\", (ev) => progressHandler(ev), true);\n  ajax.onload = function () {\n    const response = JSON.parse(this.response) as {\n      status: boolean;\n      msg: { cid: string; title: string };\n    };\n    cid = response.msg.cid;\n    title = response.msg.title;\n  };\n  ajax.addEventListener(\"load\", () => navigationHandler(), true);\n  ajax.addEventListener(\"error\", () => alert(\"Upload Failed\"), true);\n  ajax.addEventListener(\"abort\", () => alert(\"Upload Aborted\"), true);\n  ajax.open(\"POST\", server + \"/api/upload-image\");\n  ajax.send(formdata);\n}\n\nfunction progressHandler(ev: ProgressEvent<XMLHttpRequestEventTarget>) {\n  const percent = (ev.loaded / ev.total) * 100;\n\n  // Gets the progress bar & updates it.\n  const query = \"#fileUploadStats--progress-bar > div\";\n  const pb = document.querySelector(query) as HTMLDivElement;\n  pb.style.width = percent + \"%\";\n\n  // Changes the upload percent\n  content[\"fileUploadStats--uploadPercent\"].innerHTML =\n    Math.round(percent) + \"%\";\n}\n\nfunction setImageHolder(file: File) {\n  const imageHolder = content.imageHolder;\n\n  while (imageHolder.firstChild) {\n    imageHolder.removeChild(imageHolder.firstChild);\n  }\n  var reader = new FileReader();\n\n  const elem = document.createElement(\"img\");\n\n  elem.title = file.name;\n\n  imageHolder.appendChild(elem);\n\n  reader.onload = function (event) {\n    elem.src = event.target.result as string;\n  };\n\n  reader.readAsDataURL(file);\n}\n\nfunction navigationHandler() {\n  content.view1.style.display = \"none\";\n  content.view2.style.display = \"flex\";\n}\n\nfunction saveBookmark() {\n  const tag = inputs.saveBookmarkInput.value;\n\n  if (tag.length < 2) {\n    return alert(\"tag too short\");\n  }\n\n  const bookmark = {\n    cid,\n    title,\n    tag,\n  };\n\n  const options = {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    body: JSON.stringify(bookmark),\n  };\n\n  fetch(server + \"/api/bookmark-image\", options)\n    .then((data) => {\n      if (!data.ok) {\n        throw Error(\"\" + data.status);\n      }\n      return data.json();\n    })\n    .then((response) => {\n      alert(\"saved\");\n      console.log(response, \"save-bookmark\");\n    })\n    .catch((e) => {\n      console.log(e);\n    });\n}\n\nfunction getBookmark() {\n  const tag = inputs.getBookmarkInput.value;\n\n  if (tag.length < 3) {\n    return alert(\"tag too short\");\n  }\n\n  const options = {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    body: JSON.stringify({ tag }),\n  };\n\n  fetch(server + \"/api/get-bookmarks\", options)\n    .then((data) => {\n      if (!data.ok) {\n        throw Error(\"\" + data.status);\n      }\n      return data.json();\n    })\n    .then((response: { msg: any[] }) => {\n      var target = document.querySelector(\".modal .findResult\");\n\n      while (target.firstChild) {\n        target.removeChild(target.firstChild);\n      }\n\n      response.msg.forEach((res) => {\n        const template = `\n        <a href=\"https://${res.cid}.ipfs.w3s.link\">\n        <span>${res.title}</span>\n        <span>${new Date(res.createdAt).toDateString()}</span>\n        </a>\n      `;\n\n        target.insertAdjacentHTML(\"beforeend\", template);\n      });\n\n      console.log(response);\n    })\n    .catch((e) => {\n      console.log(e);\n    });\n}\n","export default async function copyTextToClipboard(text: string) {\r\n  if (\"clipboard\" in navigator) {\r\n    return await navigator.clipboard.writeText(text);\r\n  } else {\r\n    return document.execCommand(\"copy\", true, text);\r\n  }\r\n}\r\n"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","r","Symbol","toStringTag","Object","defineProperty","value","cid","title","server","inputs","forEach","id","document","getElementById","content","buttons","initUploadState","file","homeButtons","style","display","tutorial","fileUploadStats","pb","querySelector","progress","parseInt","width","innerHTML","name","uploadImage","formdata","FormData","append","ajax","XMLHttpRequest","upload","addEventListener","ev","percent","loaded","total","query","Math","round","progressHandler","onload","response","JSON","parse","this","msg","view1","view2","alert","open","send","setImageHolder","imageHolder","firstChild","removeChild","reader","FileReader","elem","createElement","appendChild","event","src","target","result","readAsDataURL","onchange","files","upload2","find","onclick","findModal","bookmark","saveModal","share","text","navigator","clipboard","writeText","execCommand","copyTextToClipboard","saveBookmark","preventDefault","tag","saveBookmarkInput","length","options","method","headers","body","stringify","fetch","then","data","ok","Error","status","json","console","log","catch","e","getBookmark","getBookmarkInput","res","template","Date","createdAt","toDateString","insertAdjacentHTML","findModalContainer","stopPropagation","saveModalContainer"],"sourceRoot":""}